[project]
name = "tpu-demo"
version = "0.1.0"
description = "JAX multi-host TPU training demo"
channels = ["conda-forge"]
platforms = ["linux-64"]

[dependencies]
python = "3.10.*"
pip = "*"

[tasks]
# Install everything needed for CIFAR-10 VAE/DDPM training on TPU via pip.
install-deps = """
python -m pip install --upgrade pip && \
python -m pip install -U "jax[tpu]" -f https://storage.googleapis.com/jax-releases/libtpu_releases.html && \
python -m pip install -U flax optax orbax-checkpoint numpy && \
python -m pip install -U tensorflow-cpu tensorflow-datasets pillow tqdm rich
"""

train = "python train.py"
devices = "python -c \"import jax; print('process_count=', jax.process_count()); print('process_index=', jax.process_index()); print(jax.devices())\""
