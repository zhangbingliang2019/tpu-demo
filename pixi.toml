[project]
name = "tpu-demo"
version = "0.1.0"
description = "JAX multi-host TPU training demo"

# IMPORTANT: pixi requires these fields here
channels = ["conda-forge"]
platforms = ["linux-64"]

[dependencies]
python = "3.10.*"

# Where to find TPU-enabled jax wheels
[pypi-options]
find-links = [
  { url = "https://storage.googleapis.com/jax-releases/libtpu_releases.html" }
]

[pypi-dependencies]
# JAX with TPU support
jax = { version = "*", extras = ["tpu"] }

# Core ML stack
flax = "*"
optax = "*"
numpy = "*"

# Data
tensorflow-cpu = "*"
tensorflow-datasets = "*"

# Image / utils
pillow = "*"
tqdm = "*"
rich = "*"

[tasks]
install-deps = "pixi install"
train = "python train.py"
devices = "python -c \"import jax; print('process_count=', jax.process_count()); print('process_index=', jax.process_index()); print(jax.devices())\""
